// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.6.2;

import "test/forge/utils/Test.sol";

interface IMurkyPredeploy {
    function getRootAndProof(bytes32[] calldata leaves, uint256 index)
        external
        pure
        returns (bytes32 root, bytes32[] memory proof);
}

abstract contract MurkyPredeployer is Test {
    IMurkyPredeploy internal murkyPredeploy;

    bytes internal constant runtimeBytecode =
        hex"608060405234801561001057600080fd5b506004361061007d5760003560e01c8063b86161951161005b578063b8616195146100ec578063cf06c7b71461010c578063dd1d25991461011f578063e27d51531461015957600080fd5b80632e08d6021461008257806358161a42146100a8578063970fde11146100cb575b600080fd5b6100956100903660046107d1565b61016c565b6040519081526020015b60405180910390f35b6100bb6100b636600461080e565b61020c565b604051901515815260200161009f565b6100de6100d936600461085e565b61027d565b60405161009f9291906108de565b6100ff6100fa36600461085e565b61029f565b60405161009f91906108f7565b61009561011a366004610911565b610426565b61009561012d36600461092a565b604080516020808201949094528082019290925280518083038201815260609092019052805191012090565b610095610167366004610911565b610563565b600060018251116101d05760405162461bcd60e51b815260206004820152602360248201527f776f6e27742067656e657261746520726f6f7420666f722073696e676c65206c60448201526232b0b360e91b60648201526084015b60405180910390fd5b6001825111156101ea576101e38261058e565b91506101d0565b816000815181106101fd576101fd61094c565b60200260200101519050919050565b81516000908290825b8181101561027157610267838783815181106102335761023361094c565b6020026020010151604080516020808201949094528082019290925280518083038201815260609092019052805191012090565b9250600101610215565b50509093149392505050565b6000606061028a8461016c565b9150610296848461029f565b90509250929050565b606060018351116102fe5760405162461bcd60e51b8152602060048201526024808201527f776f6e27742067656e65726174652070726f6f6620666f722073696e676c65206044820152633632b0b360e11b60648201526084016101c7565b600061030a8451610426565b67ffffffffffffffff81111561032257610322610720565b60405190808252806020026020018201604052801561034b578160200160208202803683370190505b50905060005b60018551111561041c57836001166001036103a65784600185038151811061037b5761037b61094c565b60200260200101518282815181106103955761039561094c565b602002602001018181525050610403565b845184600101036103c7576000801b8282815181106103955761039561094c565b8484600101815181106103dc576103dc61094c565b60200260200101518282815181106103f6576103f661094c565b6020026020010181815250505b6001016002840493506104158561058e565b9450610351565b5090505b92915050565b60006001821161043857506000919050565b600082600160801b811061045957608093841c936104569083610962565b91505b68010000000000000000841061047c57604093841c936104799083610962565b91505b640100000000841061049b57602093841c936104989083610962565b91505b6201000084106104b857601093841c936104b59083610962565b91505b61010084106104d457600893841c936104d19083610962565b91505b601084106104ef57600493841c936104ec9083610962565b91505b6004841061050a57600293841c936105079083610962565b91505b600284106105205761051d600183610962565b91505b60008161052f81196001610962565b16905081811480156105415750600083115b1561054f5750909392505050565b61055a836001610962565b95945050505050565b6000808219600101831683145b831561058657600193841c939190910190610570565b900392915050565b60608060008351905080600116600103610661576002810460010167ffffffffffffffff8111156105c1576105c1610720565b6040519080825280602002602001820160405280156105ea578160200160208202803683370190505b50915061063a8460018303815181106106055761060561094c565b602090810291909101810151604080518084019290925260008282015280518083038201815260609092019052805191012090565b826001845103815181106106505761065061094c565b6020026020010181815250506106aa565b6002810467ffffffffffffffff81111561067d5761067d610720565b6040519080825280602002602001820160405280156106a6578160200160208202803683370190505b5091505b6000805b60018303811015610716576106eb8682815181106106ce576106ce61094c565b60200260200101518783600101815181106102335761023361094c565b8483815181106106fd576106fd61094c565b60209081029190910101526001909101906002016106ae565b5091949350505050565b634e487b7160e01b600052604160045260246000fd5b600082601f83011261074757600080fd5b8135602067ffffffffffffffff8083111561076457610764610720565b8260051b604051601f19603f8301168101818110848211171561078957610789610720565b6040529384528581018301938381019250878511156107a757600080fd5b83870191505b848210156107c6578135835291830191908301906107ad565b979650505050505050565b6000602082840312156107e357600080fd5b813567ffffffffffffffff8111156107fa57600080fd5b61080684828501610736565b949350505050565b60008060006060848603121561082357600080fd5b83359250602084013567ffffffffffffffff81111561084157600080fd5b61084d86828701610736565b925050604084013590509250925092565b6000806040838503121561087157600080fd5b823567ffffffffffffffff81111561088857600080fd5b61089485828601610736565b95602094909401359450505050565b600081518084526020808501945080840160005b838110156108d3578151875295820195908201906001016108b7565b509495945050505050565b82815260406020820152600061080660408301846108a3565b60208152600061090a60208301846108a3565b9392505050565b60006020828403121561092357600080fd5b5035919050565b6000806040838503121561093d57600080fd5b50508035926020909101359150565b634e487b7160e01b600052603260045260246000fd5b8082018082111561042057634e487b7160e01b600052601160045260246000fdfea26469706673582212204f742b3c417f13a03dc67bac69d46265d0ab62ae38cf476cac84f24de3d0a4b064736f6c63430008140033";

    constructor() public {
        address where = makeAddr("MurkyPredeploy");

        vm.etch(where, runtimeBytecode);

        murkyPredeploy = IMurkyPredeploy(where);
    }
}
